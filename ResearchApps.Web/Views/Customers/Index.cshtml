@model ResearchApps.Service.Vm.CustomerVm

@{
    ViewBag.Title = "Customers";
    ViewBag.pTitle = "Customers";
    Layout = "_Layout";
}

@section styles {
    <link href="/assets/css/datatables.min.css" rel="stylesheet" type="text/css" />
}

@Html.AntiForgeryToken()

<div class="row">
    <div class="col-12">
        <table id="customer-table" 
               class="table table-bordered dt-responsive nowrap table-striped align-middle" 
               style="width: 100%;"
               data-datatable
               data-api-url="/api/Customers/"
               data-create-url="/Customers/Create"
               data-create-text="Create">
            <thead>
            <tr>
                <th>@Html.DisplayNameFor(m => m.CustomerId)</th>
                <th>@Html.DisplayNameFor(m => m.CustomerName)</th>
                <th>@Html.DisplayNameFor(m => m.Address)</th>
                <th>@Html.DisplayNameFor(m => m.Telp)</th>
                <th>@Html.DisplayNameFor(m => m.Email)</th>
                <th>@Html.DisplayNameFor(m => m.IsActive)</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tfoot>
            <tr>
                <th>@Html.DisplayNameFor(m => m.CustomerId)</th>
                <th>@Html.DisplayNameFor(m => m.CustomerName)</th>
                <th>@Html.DisplayNameFor(m => m.Address)</th>
                <th>@Html.DisplayNameFor(m => m.Telp)</th>
                <th>@Html.DisplayNameFor(m => m.Email)</th>
                <th>@Html.DisplayNameFor(m => m.IsActive)</th>
                <th>Actions</th>
            </tr>
            </tfoot>
        </table>
    </div>
</div>

@section scripts {
    <script src="assets/js/datatables.min.js"></script>
    <script type="module">
        import { DataTableComponent, ColumnRenderers } from '/assets/js/components/data-table.js';
        
        $(function() {
            DataTableComponent.init('#customer-table', {
                columns: [
                    { data: 'customerId', width: '80px' },
                    { data: 'customerName' },
                    { data: 'address' },
                    { data: 'telp', width: '120px' },
                    { data: 'email' },
                    {
                        data: 'isActive',
                        width: '80px',
                        render: ColumnRenderers.booleanBadge('Active', 'Inactive')
                    },
                    {
                        data: null,
                        width: '50px',
                        defaultContent: '',
                        orderable: false,
                        render: ColumnRenderers.actions({
                            baseUrl: '/Customers',
                            idField: 'recId',
                            extraItems: [
                                { url: '/CustomerOrders/Create?customerId={id}', icon: 'ri-file-add-line', text: 'New CO' }
                            ]
                        })
                    }
                ],
                columnDefs: [
                    { targets: [0, 5, 6], className: 'text-center' }
                ]
            });
        });
    </script>
}
